let movieArray = [{
    'title': 'The Intouchables',
    'year' : 2011,
    'poster' : 'Posters/the_intouchable.jpeg',
    'country' : ['France'],
    'genres' : ['Comedy', 'Drama']
}, {
    'title': 'Avatar',
    'year': 2009,
    'poster': 'Posters/avatar.jpg',
    'country' : ['USA'],
    'genres' : ['Adventure', 'Action', 'Drama', 'Fantasy']
}, {
    'title': 'The Amazing Spider-man',
    'year': 2012,
    'poster': 'Posters/the_amazing_spider_man.jpeg',
    'country' : ['USA'],
    'genres' : ['Adventure', 'Action', 'Fantasy']
}, {
    'title': 'Safe House',
    'year': 2012,
    'poster': 'Posters/safe_house.jpg',
    'country' : ['USA', 'Japan', 'Republic of South Africa'],
    'genres' : ['Action', 'Thriller']
}, {
    'title': 'Knifes Out',
    'year': 2019,
    'poster': 'Posters/knifes_out.jpeg',
    'country' : ['USA'],
    'genres' : ['Comedy', 'Crime', 'Drama', 'Mystery']
}, {
    'title': 'Ford v Ferrari',
    'year': 2019,
    'poster': 'Posters/ford_v_ferrari.jpg',
    'country' : ['USA'],
    'genres' : ['Action', 'Drama', 'Sport']
}, {
    'title': 'Fast Five',
    'year': 2011,
    'poster': 'Posters/fast_five.jpeg',
    'country' : ['USA', 'Japan', 'Brazil'],
    'genres' : ['Adventure', 'Action', 'Crime', 'Thriller']
}, {
    'title': 'Edge of tomorrow',
    'year': 2014,
    'poster': 'Posters/edge_of_tomorrow.jpeg',
    'country' : ['USA', 'Canada'],
    'genres' : ['Adventure', 'Action', 'Fantasy']
}, {
    'title': 'Hancock',
    'year': 2008,
    'poster': 'Posters/hancock.jpg',
    'country' : ['USA'],
    'genres' : ['Action', 'Comedy', 'Drama', 'Fantasy']
}, {
    'title': 'I Am Legend',
    'year': 2007,
    'poster': 'Posters/i_am_legend.jpg',
    'country' : ['USA'],
    'genres' : ['Adventure', 'Action', 'Drama', 'Fantasy', 'Thriller']
}, {
    'title': 'Jack Reacher',
    'year': 2012,
    'poster': 'Posters/jack_reacher.jpeg',
    'country' : ['USA'],
    'genres' : ['Action', 'Crime', 'Mystery', 'Thriller', ]
}, {
    'title': 'The Gentlemen',
    'year': 2019,
    'poster': 'Posters/the_gentlemen.jpeg',
    'country' : ['USA', 'Britain'],
    'genres' : ['Action', 'Comedy', 'Crime']
}, {
    'title': 'Lucy',
    'year': 2014,
    'poster': 'Posters/lucy.jpg',
    'country' : ['France'],
    'genres' : ['Action', 'Fantasy']
}, {
    'title': 'Avengers: Endgame',
    'year': 2019,
    'poster': 'Posters/avengers_endgame.jpeg',
    'country' : ['USA'],
    'genres' : ['Adventure', 'Action', 'Drama', 'Fantasy']
}, {
    'title': 'Lockout',
    'year': 2012,
    'poster': 'Posters/lockout.jpg',
    'country' : ['France', 'USA'],
    'genres' : ['Action', 'Fantasy', 'Thriller']
}, {
    'title': 'The Expendables',
    'year': 2010,
    'poster': 'Posters/the_expendables.jpeg',
    'country' : ['USA' ,'Spain', 'Germany', 'Bulgaria'],
    'genres' : ['Adventure', 'Action', 'Thriller']
}, {
    'title': 'Passengers',
    'year': 2016,
    'poster': 'Posters/passengers.jpg',
    'country' : ['USA', 'Australia'],
    'genres' : ['Drama', 'Fantasy', 'Romance', 'Thriller']
}, {
    'title': 'Captain America: The First Avenger',
    'year': 2011,
    'poster': 'Posters/captain_america_first_avenger.jpg',
    'country' : ['USA'],
    'genres' : ['Adventure', 'Action', 'Fantasy', 'Military']
}, {
    'title': 'Pirates of the Caribbean: On Stranger Tides',
    'year': 2011,
    'poster': 'Posters/pirates_of_the_caribbean_on_stranger_tides.jpg',
    'country' : ['USA', 'Britain'],
    'genres' : ['Adventure', 'Action', 'Comedy', 'Fantasy']
}, {
    'title': 'Prince of Persia: The Sands of Time',
    'year': 2010,
    'poster': 'Posters/prince_of_persia.jpeg',
    'country' : ['USA'],
    'genres' : ['Adventure', 'Action', 'Fantasy']
}, {
    'title': 'Friends with Benefits',
    'year': 2011,
    'poster': 'Posters/friends_with_benefits.jpg',
    'country' : ['USA'],
    'genres' : ['Comedy', 'Drama', 'Romance']
}, {
    'title': 'Jumper',
    'year': 2008,
    'poster': 'Posters/jumper.jpeg',
    'country' : ['USA', 'Canada'],
    'genres' : ['Adventure', 'Action', 'Fantasy', 'Thriller']
}, {
    'title': 'Transformers: Dark of the Moon',
    'year': 2011,
    'poster': 'Posters/transformers_dark_of_moon.jpg',
    'country' : ['USA'],
    'genres' : ['Adventure', 'Action', 'Fantasy']
}, {
    'title': 'In Time',
    'year': 2011,
    'poster': 'Posters/in_time.jpeg',
    'country' : ['USA'],
    'genres' : ['Action', 'Drama', 'Romance']
}, {
    'title': 'Total Recall',
    'year': 2012,
    'poster': 'Posters/total_recall.jpeg',
    'country' : ['USA', 'Canada'],
    'genres' : ['Adventure', 'Action', 'Fantasy', 'Thriller']
}, {
    'title': 'Green Book',
    'year': 2018,
    'poster': 'Posters/green_book.jpg',
    'country' : ['USA', 'China'],
    'genres' : ['Comedy', 'Drama']
}, {
    'title': 'Iron Man',
    'year': 2008,
    'poster': 'Posters/iron_man.jpg',
    'country' : ['USA', 'Canada'],
    'genres' : ['Adventure', 'Action', 'Fantasy']
}, {
    'title': 'The Old Guard',
    'year': 2020,
    'poster': 'Posters/the_old_guard.jpeg',
    'country' : ['USA'],
    'genres' : ['Action', 'Fantasy']
}, {
    'title': 'The Revenant',
    'year': 2015,
    'poster': 'Posters/the_revenant.jpeg',
    'country' : ['USA', 'China', 'Taiwan'],
    'genres' : ['Adventure', 'Action', 'Drama', 'Western']
}, {
    'title': 'Aquaman',
    'year': 2018,
    'poster': 'Posters/aquaman.jpg',
    'country' : ['USA', 'Australia'],
    'genres' : ['Adventure', 'Action', 'Fantasy']
}, {
    'title': 'Escape Plan',
    'year': 2013,
    'poster': 'Posters/escape_plan.jpg',
    'country' : ['USA'],
    'genres' : ['Action', 'Thriller']
}, {
    'title': 'The Martian',
    'year': 2015,
    'poster': 'Posters/the_martian.jpg',
    'country' : ['USA', 'Britain', 'Hungary'],
    'genres' : ['Adventure', 'Fantasy']
}, {
    'title': 'Tucker & Dale vs Evil',
    'year': 2010,
    'poster': 'Posters/tucker_and_dale_vs_evil.jpeg',
    'country' : ['Canada'],
    'genres' : ['Comedy', 'Horror']
}, {
    'title': 'The Accountant',
    'year': 2016,
    'poster': 'Posters/the_accountant.jpeg',
    'country' : ['USA'],
    'genres' : ['Action', 'Crime', 'Drama', 'Thriller']
}, {
    'title': 'Guardians of the Galaxy',
    'year': 2014,
    'poster': 'Posters/guardians_of_the_galaxy.jpeg',
    'country': ['USA'],
    'genres': ['Adventure', 'Action', 'Comedy', 'Fantasy']
}, {
    'title': 'The Mechanic',
    'year': 2010,
    'poster': 'Posters/the_mechanic.jpeg',
    'country' : ['USA'],
    'genres' : ['Action', 'Thriller']
}];

let firstYear = document.querySelector('.first_years_menu');
let secondYear = document.querySelector('.second_years_menu');
let movieGenre = document.querySelector('.movie_genres');
let movieCountry = document.querySelector('.movie_country');

let firstYearVal = firstYear.value;
let secondYearVal = secondYear.value;

let showHomePage = function () {
    let main = document.querySelector('.main_body');

    let div = document.createElement('div');
    div.className = 'main_movie_list';

    let ul = document.createElement('ul');
    ul.className = 'movie_list';

    main.prepend(div);
    div.prepend(ul);

    for (let i = 0; i < movieArray.length; i++) {
        let title = movieArray[i].title;
        let poster = movieArray[i].poster;

        showMovie(ul, title, poster);
    }
}

let showMovie = function (ul, title, poster) {
    let li = document.createElement('li');
    li.className = 'movie_list_item';

    let img = document.createElement('img');
    img.src = poster;
    img.height = '228';
    img.width = '160';

    let div = document.createElement('div');
    div.className = 'movie_title_background';

    let span = document.createElement('span');
    span.className = 'movie_title';
    span.innerHTML = title;

    div.prepend(span);
    li.prepend(img);
    li.append(div);
    ul.append(li);
}

showHomePage();

let showYear = function () {
    if (firstYear.value > secondYear.value) {
        alert (`You can't choose this year.`);

        firstYear.value = firstYearVal;
        secondYear.value = secondYearVal;

        return;
    }

    firstYearVal = firstYear.value;
    secondYearVal = secondYear.value;

    showMovieList();
}

let showMovieList = function () {
    let movieList = document.querySelectorAll('.movie_list_item');

    for(let i = 0; i < movieList.length; i++) {
        movieList[i].remove();
    }

    let currentMovieArray = movieArray;

    if (movieGenre.value != 'All genres') {
        currentMovieArray = showGenres (currentMovieArray, movieGenre.value);
    }

    if (movieCountry.value != 'All countries') {
        currentMovieArray = showCountries (currentMovieArray, movieCountry.value);
    }

    for( let i = 0; i < currentMovieArray.length; i++) {
        if (currentMovieArray[i].year >= firstYear.value && currentMovieArray[i].year <= secondYear.value) {
            let title = currentMovieArray[i].title;
            let poster = currentMovieArray[i].poster;

            let ul = document.querySelector('.movie_list')

            showMovie(ul, title, poster);
        }
    }
}

let showCountries = function (array, country) {
    let newMovieArray = [];

    for (let i = 0; i < array.length; i++) {
        if (checkCountry(array[i], country) == true) {
            newMovieArray.push(array[i]);
        }
    }

    return(newMovieArray);
}

let checkCountry = function (movie, country) {
    let movieCountries = movie.genres;
    let count = 0;

    for (let i = 0; i < movie.country.length; i++) {
        if (movie.country[i] == country) count++;
    }

    if (count > 0) return true;
    else return false;
}

let showGenres = function (array, genre) {
    let newMovieArray = [];

    for (let i = 0; i < array.length; i++) {
        if (checkGenre(array[i], genre) == true) {
            newMovieArray.push(array[i]);
        }
    }

    return(newMovieArray);
}

let checkGenre = function (movie, genre) {
    let movieGenres = movie.genres;
    let count = 0;

    for (let i = 0; i < movie.genres.length; i++) {
        if (movie.genres[i] == genre) count++;
    }

    if (count > 0) return true;
    else return false;
}





